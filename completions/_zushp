#compdef zushp zushp_update

# Zush Plugin Manager Completions

_zushp() {
    local context state line
    
    case $service in
        zushp)
            _arguments \
                '1:repository:_zushp_repositories' \
                && return 0
            ;;
        zushp_update)
            _arguments \
                '::plugin name:_zushp_installed_plugins' \
                && return 0
            ;;
    esac
}

# Complete GitHub repositories (basic format)
_zushp_repositories() {
    _describe 'repository' \
        'user/repo:GitHub repository (user/repo format)'
}

# Complete installed plugin names
_zushp_installed_plugins() {
    local plugins
    if [[ -f "${ZUSH_CACHE_DIR:-$HOME/.cache/zush}/plugins-manifest" ]]; then
        plugins=(${(f)"$(cut -d: -f1 "${ZUSH_CACHE_DIR:-$HOME/.cache/zush}/plugins-manifest" 2>/dev/null)"})
        _describe 'plugin' plugins
    fi
}

_zushp "$@"